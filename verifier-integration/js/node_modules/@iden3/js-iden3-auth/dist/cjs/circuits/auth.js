"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AuthPubSignals = void 0;
const core_1 = require("../core/core");
const id_1 = require("../core/id");
const ownershipVerifier_1 = require("./ownershipVerifier");
class AuthPubSignals extends ownershipVerifier_1.IDOwnershipPubSignals {
    constructor(pubSignals) {
        super();
        if (pubSignals.length != 3) {
            throw new Error(`invalid number of Output values expected ${3} got ${pubSignals.length}`);
        }
        this.challenge = BigInt(pubSignals[0]);
        this.userState = BigInt(pubSignals[1]);
        const bytes = core_1.Core.intToBytes(BigInt(pubSignals[2]));
        this.userId = id_1.Id.idFromBytes(bytes);
    }
    async verifyQuery(_query) {
        throw new Error('Method not implemented.');
    }
    async verifyStates(resolver) {
        const userStateResolved = await resolver.resolve(this.userId.bigInt(), this.userState);
        if (!userStateResolved.latest) {
            throw new Error(`only latest states are supported`);
        }
        return;
    }
}
exports.AuthPubSignals = AuthPubSignals;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jaXJjdWl0cy9hdXRoLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHVDQUFvQztBQUNwQyxtQ0FBZ0M7QUFJaEMsMkRBQTREO0FBRTVELE1BQWEsY0FDWCxTQUFRLHlDQUFxQjtJQUs3QixZQUFZLFVBQW9CO1FBQzlCLEtBQUssRUFBRSxDQUFDO1FBQ1IsSUFBSSxVQUFVLENBQUMsTUFBTSxJQUFJLENBQUMsRUFBRTtZQUMxQixNQUFNLElBQUksS0FBSyxDQUNiLDRDQUE0QyxDQUFDLFFBQzNDLFVBQVUsQ0FBQyxNQUNiLEVBQUUsQ0FDSCxDQUFDO1NBQ0g7UUFDRCxJQUFJLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN2QyxJQUFJLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUV2QyxNQUFNLEtBQUssR0FBZSxXQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pFLElBQUksQ0FBQyxNQUFNLEdBQUcsT0FBRSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN0QyxDQUFDO0lBQ0QsS0FBSyxDQUFDLFdBQVcsQ0FBQyxNQUFhO1FBQzdCLE1BQU0sSUFBSSxLQUFLLENBQUMseUJBQXlCLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUQsS0FBSyxDQUFDLFlBQVksQ0FBQyxRQUF3QjtRQUN6QyxNQUFNLGlCQUFpQixHQUFrQixNQUFNLFFBQVEsQ0FBQyxPQUFPLENBQzdELElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLEVBQ3BCLElBQUksQ0FBQyxTQUFTLENBQ2YsQ0FBQztRQUNGLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLEVBQUU7WUFDN0IsTUFBTSxJQUFJLEtBQUssQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDO1NBQ3JEO1FBQ0QsT0FBTztJQUNULENBQUM7Q0FDRjtBQW5DRCx3Q0FtQ0MifQ==